---
title: Derive the variance for the hypergeometric distribution
author: ''
date: '2020-12-28'
slug: derive-the-variance-for-the-hypergeometric-distribution
categories: []
tags: []
subtitle: ''
summary: ''
authors: []
lastmod: '2020-12-28T13:24:05-05:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
bibliography: [../../../static/bib/utexas.bib]
math: true
---

<link href="/rmarkdown-libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="/rmarkdown-libs/anchor-sections/anchor-sections.js"></script>


<div id="how-to-derive-the-variance-for-the-hypergeometric-distribution." class="section level3">
<h3>How to derive the variance for the Hypergeometric Distribution.</h3>
<p>The <strong>hypergeometric distribution</strong> is a discrete probability distribution that describes the probability of <span class="math inline">\(k\)</span> successes (random draws for which the object drawn has a specified feature) in <span class="math inline">\(n\)</span> draws, without replacement, from a finite population of size <span class="math inline">\(N\)</span> that contains exactly <span class="math inline">\(K\)</span> objects with that feature, wherein each draw is either a success or a failure <span class="citation">(Wikipedia 2020)</span>.</p>
<hr />
<p>Let <span class="math inline">\(X\)</span> be a random variable that follows the hypergeometric distribution. Then, <span class="math inline">\(X\)</span> has a probability mass function given by</p>
<p><span class="math display">\[\begin{equation}
p_X(k) = P[X=k | N, K, n] = \frac{{K \choose k}{N-K \choose n-k}}{N \choose n}
\end{equation}\]</span></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\(N\)</span> is the population size,</p></li>
<li><p><span class="math inline">\(K\)</span> is the number of success states in the population,</p></li>
<li><p><span class="math inline">\(n\)</span> is the number of draws (quanity drawn in each trial),</p></li>
<li><p><span class="math inline">\(k\)</span> is the number of observed successes, and</p></li>
<li><p><span class="math inline">\({a \choose b}\)</span> is a binomial coefficient.</p></li>
</ul>
<hr />
<p>The expected value of <span class="math inline">\(X\)</span> is given by</p>
<p><span class="math display">\[\begin{equation}
\mathbb{E}[X] = \mu = \sum_{k \in S} k \frac{{K \choose k}{N-K \choose n-k}}{N \choose n},
\end{equation}\]</span></p>
<p>which reduces to the expression</p>
<p><span class="math display" id="eq:mean">\[\begin{equation}
\mathbb{E}[X] = \frac{nK}{N}. \tag{1}
\end{equation}\]</span></p>
<hr />
<p>It is understood that the sum of all probabilities for <span class="math inline">\(k \in S\)</span> equals 1,</p>
<p><span class="math display" id="eq:one">\[\begin{equation}
\mathbb{E}[X] = \sum_{k \in S} \frac{{K \choose k}{N-K \choose n-k}}{N \choose n} = 1 \tag{2}.
\end{equation}\]</span></p>
<hr />
<p>The variance of <span class="math inline">\(X\)</span> is given by</p>
<p><span class="math display" id="eq:variance">\[\begin{equation}
\mathbb{V}[X] = \sum_{k \in S} (k - \frac{nK}{N})^2 \frac{{K \choose k}{N-K \choose n-k}}{N \choose n} \tag{3}.
\end{equation}\]</span></p>
<hr />
<p>As require, we have the <a href="/misc-statistics/binomial-coefficient-identities/#number-one">binomial coefficient identity</a></p>
<p><span class="math display" id="eq:required">\[\begin{equation}
{N \choose n} = {\left( \frac Nn \right)}{N-1 \choose n-1}. \tag{4}
\end{equation}\]</span></p>
<hr />
<p>We begin our derivation of the variance by expanding the definition given by <strong>Eq.</strong> <a href="#eq:variance">(3)</a>,</p>
<p><span class="math display" id="eq:expand3" id="eq:expand2" id="eq:expand1">\[\begin{align}
\mathbb{V}[X] = &amp; \                    \sum_{k \in S} k^2 \frac{{K \choose k}{N-K \choose n-k}}{N \choose n} \tag{5} \\\\
              - &amp; \ \frac{2nK}{N}      \sum_{k \in S} k   \frac{{K \choose k}{N-K \choose n-k}}{N \choose n} \tag{6} \\\\
              + &amp; \ \frac{n^2K^2}{N^2} \sum_{k \in S}     \frac{{K \choose k}{N-K \choose n-k}}{N \choose n} \tag{7}.
\end{align}\]</span></p>
<hr />
<p>The summand in <strong>Eq. <a href="#eq:expand2">(6)</a></strong> equals the expected value of <span class="math inline">\(X\)</span>, as given by <strong>Eq. <a href="#eq:mean">(1)</a></strong>. And, the summand in <strong>Eq. <a href="#eq:expand3">(7)</a></strong> equals the sum of all probabilities for <span class="math inline">\(k \in S\)</span>, which equals 1 as given by <a href="#eq:one">(2)</a>.</p>
<p>Making these substitutions gives us the following reduced expression</p>
<p><span class="math display">\[\begin{align}
\mathbb{V}[X] = &amp; \                    \sum_{k \in S} k^2 \frac{{K \choose k}{N-K \choose n-k}}{N \choose n} \\\\
              - &amp; \ \frac{2nK}{N}      \cdot \frac{nK}{N} \\\\
              + &amp; \ \frac{n^2K^2}{N^2} \cdot 1.
\end{align}\]</span></p>
<p>This expression simplies to</p>
<p><span class="math display" id="eq:expand4">\[\begin{align}
\mathbb{V}[X] = &amp; \ \sum_{k \in S} k^2 \frac{{K \choose k}{N-K \choose n-k}}{N \choose n} \tag{8}\\\\
              - &amp; \ \frac{n^2K^2}{N^2}.
\end{align}\]</span></p>
<hr />
<p>Next, we apply our binomial coefficient identity Eq. <a href="#eq:required">(4)</a> to both the binomial coefficient <span class="math inline">\(K \choose k\)</span> and the binomial coefficient <span class="math inline">\({N \choose n}\)</span> to Eq. <a href="#eq:expand4">(8)</a>, which gives the expression</p>
<p><span class="math display" id="eq:expand5">\[\begin{align}
\mathbb{V}[X] = &amp; - \frac{n^2K^2}{N^2} 
                  + \sum_{k \in S} k^2 \frac {\left( \frac Kk \right) {K-1 \choose k-1}{N-K \choose n-k}} {\left( \frac Nn \right) {N-1 \choose n-1}} \\\\

              = &amp; - \frac{n^2K^2}{N^2}
                  + \frac{nK}{N} \sum_{k \in S} k \frac{{K-1 \choose k-1}{N-K \choose n-k}}{N-1 \choose n-1} \tag{9}\\\\
\end{align}\]</span></p>
<hr />
<p>Now, we use a re-write <span class="math inline">\(k\)</span> as <span class="math inline">\((k-1)+1\)</span> and further expand Eq. <a href="#eq:expand5">(9)</a>, which gives the expression</p>
<p><span class="math display" id="eq:expand7" id="eq:expand6">\[\begin{align}
\mathbb{V}[X] = &amp; - \frac{n^2K^2}{N^2} \\\\

                &amp; + \frac{nK}{N} \sum_{0 \lt k \in S} \frac{ (k-1) {K-1 \choose k-1}{N-K \choose n-k}}{N-1 \choose n-1} \tag{10}\\\\
                  
                &amp; + \frac{nK}{N} \sum_{0 \lt k \in S} \frac{{K-1 \choose k-1}{N-K \choose n-k}}{N-1 \choose n-1}  \tag{11}
\end{align}\]</span></p>
<hr />
<p>The summand in Eq. <a href="#eq:expand6">(10)</a> is the expected value for a hypergeometric distribution, as expressed by Eq. <a href="#eq:mean">(1)</a>,</p>
<p><span class="math display">\[\begin{equation}
\mathbb{E}[X] = \frac{(n-1)(K-1)}{N-1}.
\end{equation}\]</span></p>
<p>And, the summand in Eq. <a href="#eq:expand7">(11)</a> is the sum of all probabilities for a hypergeometric distribution, which sums to 1, as expressed by Eq. <a href="#eq:one">(2)</a>. Together, these observations,simply our expression for the variance further,</p>
<p><span class="math display" id="eq:expand8">\[\begin{equation}
\mathbb{V}[X] = - \frac{n^2K^2}{N^2} + \frac{nK(n-1)(K-1)}{N(N-1)} + \frac{nK}{N} \tag{12}
\end{equation}\]</span></p>
<hr />
<p>Basic simplification techniques on Eq. <a href="#eq:expand8">(12)</a> yield our final result.</p>
<p><span class="math display" id="eq:expand8">\[\begin{align}
\mathbb{V}[X] = &amp; \ - \frac{n^2K^2}{N^2} + \frac{nK(n-1)(K-1)}{N(N-1)} + \frac{nK}{N} \tag{12} \\\\
              = &amp; \   \frac{-n^2K^2(N-1) + nK(n-1)(K-1)N + nKN(N-1)} {N^2(N-1)} \\\\
              = &amp; \   \frac{nK[N(n-1)(K-1)+N(N-1)-nK(N-1)]} {N^2(N-1)} \\\\
              = &amp; \   \frac{nK[nNK-NK-nN+N+N^2-N-nKN+nK]} {N^2(N-1)} \\\\
              = &amp; \   \frac{nK[\cancel{nNK}-NK-nN+\cancel{N}+N^2-\cancel{N}-\cancel{nKN}+nK]} {N^2(N-1)} \\\\
              = &amp; \   \frac{nK[-NK-nN+N^2+nK]} {N^2(N-1)} \\\\
              = &amp; \   \frac{nK[N^2+(-K-n)N+nK]} {N^2(N-1)} \\\\
              = &amp; \   \frac{nK(N-K)(N-n)} {N^2(N-1)} \\\\
              = &amp; \ n \frac KN \left( 1- \frac KN \right) \left( \frac{N-n}{N-1} \right) \\\\
\end{align}\]</span></p>
<p>And so be it,</p>
<div class="highlight">
<p><span class="math display">\[\begin{equation}
\mathbb{V}[X] = n \frac KN \left( 1- \frac KN \right) \left( \frac{N-n}{N-1} \right).
\end{equation}\]</span></p>
</div>
</div>
<div id="references" class="section level3 unnumbered">
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Wikipedia2020b">
<p>Wikipedia. 2020. “Hypergeometric distribution.”</p>
</div>
</div>
</div>
